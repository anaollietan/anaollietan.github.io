(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20995,e=>{"use strict";var t,l=((t={}).Available="Available",t.CheckedOut="CheckedOut",t.Deactivated="Deactivated",t);e.s(["EquipmentStatus",()=>l])},75476,e=>{"use strict";var t,l=e.i(43476),r=e.i(71645),s=((t={}).CheckedOut="CheckedOut",t.CheckedIn="CheckedIn",t),n=e.i(20995),a=e.i(85369),c=e.i(11110);function d({editingItem:e,equipment:t,users:s,onSubmit:a,onCancel:d}){let{t:i}=(0,c.useLanguage)(),o=s.find(e=>"Ollie Tan"===e.Name),u=o?.Id||"",[m,x]=(0,r.useState)({UserId:u,EquipmentId:"",CheckedOutAt:new Date().toISOString().slice(0,16),CheckedInAt:null,ReferenceType:"Manual",ReferenceId:""});(0,r.useEffect)(()=>{e?x({UserId:e.UserId,EquipmentId:e.EquipmentId,CheckedOutAt:e.CheckedOutAt.slice(0,16),CheckedInAt:e.CheckedInAt,ReferenceType:e.ReferenceType,ReferenceId:e.ReferenceId}):x({UserId:u,EquipmentId:"",CheckedOutAt:new Date().toISOString().slice(0,16),CheckedInAt:null,ReferenceType:"Manual",ReferenceId:""})},[e,u]);let h=e=>{let{name:t,value:l}=e.target;x(e=>({...e,[t]:l||("CheckedInAt"===t?null:l)}))},p=t.filter(t=>t.Status===n.EquipmentStatus.Available||e&&t.Id===e.EquipmentId);return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 overflow-y-auto max-h-[calc(100vh-12rem)]",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:i(e?"checkout_log.form.title.edit":"checkout_log.form.title.add")}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(m)},className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"UserId",className:"block text-sm font-medium text-gray-700 mb-1",children:i("checkout_log.form.user_required")}),(0,l.jsxs)("select",{id:"UserId",name:"UserId",value:m.UserId,onChange:h,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:[(0,l.jsx)("option",{value:"",children:i("placeholder.select_user")}),s.map(e=>(0,l.jsx)("option",{value:e.Id,children:e.Name},e.Id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"EquipmentId",className:"block text-sm font-medium text-gray-700 mb-1",children:i("checkout_log.form.equipment_required")}),e?(0,l.jsxs)("select",{id:"EquipmentId",name:"EquipmentId",value:m.EquipmentId,disabled:!0,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:[(0,l.jsx)("option",{value:"",children:i("placeholder.select_equipment")}),p.map(e=>(0,l.jsxs)("option",{value:e.Id,children:[e.Name," (",e.SerialNumber,")"]},e.Id))]}):(0,l.jsxs)("select",{id:"EquipmentId",name:"EquipmentId",value:m.EquipmentId,onChange:h,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:[(0,l.jsx)("option",{value:"",children:i("placeholder.select_equipment")}),p.map(e=>(0,l.jsxs)("option",{value:e.Id,children:[e.Name," (",e.SerialNumber,")"]},e.Id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"CheckedOutAt",className:"block text-sm font-medium text-gray-700 mb-1",children:i("checkout_log.form.checked_out_at")}),(0,l.jsx)("input",{type:"datetime-local",id:"CheckedOutAt",name:"CheckedOutAt",value:m.CheckedOutAt,onChange:h,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"ReferenceId",className:"block text-sm font-medium text-gray-700 mb-1",children:i("checkout_log.form.note")}),(0,l.jsx)("input",{type:"text",id:"ReferenceId",name:"ReferenceId",value:m.ReferenceId,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900"})]}),(0,l.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,l.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors font-medium",children:i(e?"button.update":"button.check_out")}),e&&(0,l.jsx)("button",{type:"button",onClick:d,className:"px-6 bg-gray-500 text-white py-2 rounded-md hover:bg-gray-600 transition-colors font-medium",children:i("button.cancel")})]})]})]})}function i({items:e,equipment:t,users:r,onEdit:s,onCheckIn:n}){let{t:a}=(0,c.useLanguage)(),d=e=>e?new Date(e).toLocaleString():"-";return(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.equipment")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.user")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.checked_out_at")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.checked_in_at")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.note")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.status")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("checkout_log.table.header.actions")})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===e.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:a("checkout_log.table.empty")})}):e.map(e=>{var c,i;let o,u;return(0,l.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>s(e),children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(c=e.EquipmentId,(o=t.find(e=>e.Id===c))?`${o.Name} (${o.SerialNumber})`:a("checkout_log.table.unknown"))}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(i=e.UserId,(u=r.find(e=>e.Id===i))?u.Name:a("checkout_log.table.unknown"))}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d(e.CheckedOutAt)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d(e.CheckedInAt)}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.ReferenceType,": ",e.ReferenceId.slice(0,8),"..."]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.CheckedInAt?(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:a("checkout_status.checked_in")}):(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:a("checkout_status.checked_out")})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:!e.CheckedInAt&&(0,l.jsx)("button",{onClick:t=>{var l;return l=e.Id,void(t.stopPropagation(),confirm(a("checkout_log.table.confirm_check_in"))&&n(l))},className:"bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 transition-colors text-xs font-medium",children:a("button.check_in")})})]},e.Id)})})]})})})}function o({statusFilter:e,userFilter:t,equipmentFilter:r,users:n,equipment:a,onStatusFilterChange:d,onUserFilterChange:i,onEquipmentFilterChange:o,onReset:u}){let m,{t:x}=(0,c.useLanguage)(),h=[{value:"All",label:x("checkout_log.filter.all_status")},{value:s.CheckedOut,label:x("checkout_status.checked_out")},{value:s.CheckedIn,label:x("checkout_status.checked_in")}],p=()=>"All"===e&&""===t&&""===r;return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-end gap-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,l.jsx)("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:x("checkout_log.filter.status")}),(0,l.jsx)("select",{id:"status-filter",value:e,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:h.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,l.jsx)("label",{htmlFor:"user-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:x("checkout_log.filter.user")}),(0,l.jsxs)("select",{id:"user-filter",value:t,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:[(0,l.jsx)("option",{value:"",children:x("checkout_log.filter.all_users")}),n.map(e=>(0,l.jsx)("option",{value:e.Id,children:e.Name},e.Id))]})]}),(0,l.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,l.jsx)("label",{htmlFor:"equipment-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:x("checkout_log.filter.equipment")}),(0,l.jsxs)("select",{id:"equipment-filter",value:r,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:[(0,l.jsx)("option",{value:"",children:x("checkout_log.filter.all_equipment")}),a.map(e=>(0,l.jsx)("option",{value:e.Id,children:e.Name},e.Id))]})]}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{onClick:u,disabled:p(),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${p()?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-600 text-white hover:bg-gray-700"}`,children:x("button.reset_filters")})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:x("checkout_log.filter.active")}),(0,l.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:(m=h.find(t=>t.value===e))?m.label:e}),(0,l.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium",children:(e=>{if(!e)return x("checkout_log.filter.all_users");let t=n.find(t=>t.Id===e);return t?t.Name:x("checkout_log.filter.all_users")})(t)}),(0,l.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:(e=>{if(!e)return x("checkout_log.filter.all_equipment");let t=a.find(t=>t.Id===e);return t?t.Name:x("checkout_log.filter.all_equipment")})(r)})]})]})}var u=e.i(24767);function m({isOpen:e,equipmentId:t,userId:s,onClose:n,onSubmit:a}){let{t:d}=(0,c.useLanguage)(),[i,o]=(0,r.useState)([{tempId:Date.now().toString(),EquipmentId:t,UserId:s,ReferenceType:u.ReferenceType.DN,ReferenceNumber:"",Timestamp:new Date().toISOString().slice(0,16)}]),m=(e,t,l)=>{o(i.map(r=>r.tempId===e?{...r,[t]:l}:r))};return e?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto m-4",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:d("check_in_modal.title")}),(0,l.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"Ã—"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:d("check_in_modal.description")}),(0,l.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),i.every(e=>""!==e.ReferenceNumber.trim()))?a(i.map(({tempId:e,...t})=>t)):alert(d("check_in_modal.error.empty_reference"))},children:[i.map((e,t)=>(0,l.jsxs)("div",{className:"border border-gray-300 rounded-md p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:d("check_in_modal.log_number",{number:t+1})}),i.length>1&&(0,l.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.tempId,void(i.length>1&&o(i.filter(e=>e.tempId!==t)))},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:d("button.remove")})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:d("usage_log.form.reference_type")}),(0,l.jsxs)("select",{value:e.ReferenceType,onChange:t=>m(e.tempId,"ReferenceType",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",children:[(0,l.jsx)("option",{value:u.ReferenceType.DN,children:d("reference_type.dn")}),(0,l.jsx)("option",{value:u.ReferenceType.WO,children:d("reference_type.wo")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[d("usage_log.form.reference_number")," *"]}),(0,l.jsx)("input",{type:"text",value:e.ReferenceNumber,onChange:t=>m(e.tempId,"ReferenceNumber",t.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:d("placeholder.reference_number_usage")})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[d("usage_log.form.timestamp")," *"]}),(0,l.jsx)("input",{type:"datetime-local",value:e.Timestamp,onChange:t=>m(e.tempId,"Timestamp",t.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900"})]})]})]},e.tempId)),(0,l.jsxs)("button",{type:"button",onClick:()=>{o([...i,{tempId:Date.now().toString(),EquipmentId:t,UserId:s,ReferenceType:u.ReferenceType.DN,ReferenceNumber:"",Timestamp:new Date().toISOString().slice(0,16)}])},className:"w-full mb-4 py-2 px-4 border-2 border-dashed border-blue-400 text-blue-600 rounded-md hover:border-blue-600 hover:text-blue-700 transition-colors font-medium flex items-center justify-center",children:[(0,l.jsx)("span",{className:"text-xl mr-2",children:"+"}),d("check_in_modal.add_log")]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors font-medium",children:d("button.check_in_submit")}),(0,l.jsx)("button",{type:"button",onClick:n,className:"px-6 bg-gray-500 text-white py-2 rounded-md hover:bg-gray-600 transition-colors font-medium",children:d("button.cancel")})]})]})]})})}):null}function x(){let{t:e}=(0,c.useLanguage)(),[t,u]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[f,b]=(0,r.useState)(null),[y,j]=(0,r.useState)(0),[k,v]=(0,r.useState)("All"),[N,I]=(0,r.useState)(""),[_,w]=(0,r.useState)(""),[C,q]=(0,r.useState)(!1),[S,A]=(0,r.useState)(null);(0,r.useEffect)(()=>{R();let e=new URLSearchParams(window.location.search).get("equipmentId");e&&w(e)},[]);let R=()=>{let e=a.checkoutLogStorage.getAll(),t=a.equipmentStorage.getAll(),l=a.userStorage.getAll();e.sort((e,t)=>new Date(t.CheckedOutAt).getTime()-new Date(e.CheckedOutAt).getTime()),u(e),h(t),g(l)},E=t.filter(e=>{let t=e.CheckedInAt?s.CheckedIn:s.CheckedOut,l="All"===k||t===k,r=!N||e.UserId===N,n=!_||e.EquipmentId===_;return l&&r&&n}),O=S?a.checkoutLogStorage.getById(S):null;return(0,l.jsxs)("div",{className:"h-full overflow-y-auto",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:e("page.checkout_log.title")}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsx)(d,{editingItem:f,equipment:x,users:p,onSubmit:e=>{if(f)a.checkoutLogStorage.update(f.Id,e),b(null);else{a.checkoutLogStorage.create(e);let t=a.equipmentStorage.getById(e.EquipmentId);t&&a.equipmentStorage.update(e.EquipmentId,{...t,Status:n.EquipmentStatus.CheckedOut}),j(e=>e+1)}R()},onCancel:()=>{b(null)}},y)}),(0,l.jsxs)("div",{className:"lg:col-span-2 overflow-auto",children:[(0,l.jsx)(o,{statusFilter:k,userFilter:N,equipmentFilter:_,users:p,equipment:x,onStatusFilterChange:v,onUserFilterChange:I,onEquipmentFilterChange:w,onReset:()=>{v("All"),I(""),w("")}}),(0,l.jsx)(i,{items:E,equipment:x,users:p,onEdit:e=>{b(e)},onCheckIn:e=>{a.checkoutLogStorage.getById(e)&&(A(e),q(!0))}})]})]}),O&&(0,l.jsx)(m,{isOpen:C,equipmentId:O.EquipmentId,userId:O.UserId,onClose:()=>{q(!1),A(null)},onSubmit:e=>{if(!S)return;let t=a.checkoutLogStorage.getById(S);if(!t)return;e.forEach(e=>{a.usageLogStorage.create(e)}),a.checkoutLogStorage.checkIn(S);let l=a.equipmentStorage.getById(t.EquipmentId);l&&a.equipmentStorage.update(t.EquipmentId,{...l,Status:n.EquipmentStatus.Available}),q(!1),A(null),R()}})]})}e.s(["default",()=>x],75476)}]);